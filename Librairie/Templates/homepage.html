{% from "macro.html" import show_article %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My website</title>
    <link rel="stylesheet" href="../static/homepage.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <header class="header">
        <a href="#" class="logo">Logo</a>

        <input type="checkbox" id="check">

        <label for="check" class="icons">
            <i class='bx bx-menu' id="menu-icon"></i>
            <i class='bx bx-x' id="close-icon"></i>
        </label>

        <nav class="navbar">
            <a href="/articles/homepage" style="--i:0;">Home</a>
            <a href="#" style="--i:1;">About</a>
            <a href="#" style="--i:2;">Gallery</a>
            <a href="#" style="--i:3;">Services</a>
            <a href="#" style="--i:4;">Me</a>
        </nav>
    </header>

    <div class="feed-container">
        {% for article in articles %}
        {{ show_article(article.id, article.author_username, article.title, article.date, article.content, article.theme, article.likes, article.dislikes, article) }}
        <div class="comment-form-container" id="comment-form-{{ article.id }}">
            <form method="post" action="/post_comment" onsubmit="postComment(event, {{ article.id }})">
                <textarea name="comment" placeholder="Write your comment" required></textarea>
                <input type="hidden" name="article_id" value="{{ article.id }}">
                <button type="submit">Post Comment</button>
            </form>
        </div>
        {% endfor %}
    </div>
    
    <script>
    function toggleComments(articleId) {
    const commentsContainer = document.getElementById(`comments-container-${articleId}`);
    if (commentsContainer.style.display === "none" || commentsContainer.style.display === "") {
        commentsContainer.style.display = "block";
    } else {
        commentsContainer.style.display = "none";
    }
}
        
       function toggleCommentForm(articleId) {
    const form = document.getElementById(`comment-form-${articleId}`);
    const button = document.getElementsByClassName(`comment-toggle-btn`);
    if (form.style.display === "none") {
        form.style.display = "block";
        button.style.display = "none";
    } else {
        form.style.display = "none";
        button.style.display = "block";
    }
}


        async function loadComments(articleId) {
    try {
        const response = await fetch('/articles/load_comments', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ article_id: articleId })
        });
        const data = await response.json();
        return data.comments;
    } catch (error) {
        console.error('Error loading comments:', error);
    }
}

    // Exemple d'utilisation : appeler cette fonction lorsque l'utilisateur appuie sur un bouton
    async function handleLoadCommentsButtonClick(articleId) {
        const comments = await loadComments(articleId);
        // Utilisez les commentaires récupérés pour mettre à jour l'interface utilisateur
        console.log('Comments:', comments);
}

    </script>

</body>
</html>

